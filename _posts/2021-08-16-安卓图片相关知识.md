---
layout: post
title: 安卓图片相关知识
date: 2021-08-16
tags: 安卓
---

## 图片

* 图片加载到内存中时，会比源文件大很多，具体大多少要看采用什么格式加载到内存带透明通道比不带要大很多 ARGB_8888 RGB_565
* 在Android中,直接从资源文件加载到的图片是不能进行操作的,只能进行显示，想要进行操作,可以复制一张图片到内存,然后操作复制到的图片
* 加载大图，按比例压缩图片首先就是要获取图片的大小，options.inSampleSize = r;//设置压缩比  ， options.inJustDecodeBounds = false;//设置加载图片内容 true的话只加载参数，不分配内存
* 加载多图，使用内存缓存策略LRU等。 获取可用的最大内存`int maxMemory = (int) (Runtime.getRuntime().maxMemory() / 1024);` 使用最大可用内存值的1/8作为缓存的大小。
* 压缩方式：
* `质量压缩`:保持像素的前提下改变图片的位深及透明度（即：通过算法抹掉(同化)图片中的一些某点附近 相近的像素）达到降低质量压缩文件的目的。 `使用场景`：将图片压缩后将图片上传到服务器，或者保存到本地，根据实际需求
* `尺寸压缩`:通过减少单位尺寸的像素值，真正意义上的降低像素（通过缩放图片像素来减少图片占用内存大小） `使用场景`：缓存缩略图的时候（头像处理）
* `采样率压缩`:设置图片的采样率，降低图片像素 好处：是不会先将大图片读入内存，大大减少了内存的使用，也不必考虑将大图片读入内存后的释放事宜。 问题：因为采样率是整数，所以不能很好的保证图片的质量。


## Glide主线流程分析
Glide
.with() --->  创建空白的fragment，绑定activity生命周期（jetpack中的lifecycle也是用这个原理）
.load() --->  三级缓存，内存，磁盘，网络，LRU算法
.into()



## 试题

### Glide不能在子线程中with？
答：子线程，不会去添加生命周期机制。主线程才会添加空白的Fragment监听Activity生命周期变化。


























-----------
